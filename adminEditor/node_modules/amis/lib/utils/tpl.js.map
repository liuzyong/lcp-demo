{
    "version": 3,
    "file": "tpl.js",
    "sourceRoot": "",
    "sources": [
        "/src/utils/tpl.ts"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import {createObject} from './helper';\nimport {register as registerBulitin, getFilters} from './tpl-builtin';\nimport {register as registerLodash} from './tpl-lodash';\n\nexport interface Enginer {\n  test: (tpl: string) => boolean;\n  compile: (tpl: string, data: object, ...rest: Array<any>) => string;\n}\n\nconst enginers: {\n  [propName: string]: Enginer;\n} = {};\n\nexport function reigsterTplEnginer(name: string, enginer: Enginer) {\n  enginers[name] = enginer;\n}\n\n[registerBulitin, registerLodash].forEach(fn => fn());\n\nexport function filter(\n  tpl?: string,\n  data: object = {},\n  ...rest: Array<any>\n): string {\n  if (!tpl || typeof tpl !== 'string') {\n    return '';\n  }\n\n  let keys = Object.keys(enginers);\n  for (let i = 0, len = keys.length; i < len; i++) {\n    let enginer = enginers[keys[i]];\n    if (enginer.test(tpl)) {\n      return enginer.compile(tpl, data, ...rest);\n    }\n  }\n\n  return tpl;\n}\n\nlet customEvalExpressionFn: (expression: string, data?: any) => boolean;\nexport function setCustomEvalExpression(\n  fn: (expression: string, data?: any) => boolean\n) {\n  customEvalExpressionFn = fn;\n}\n\n// 几乎所有的 visibleOn requiredOn 都是通过这个方法判断出来结果，很粗暴也存在风险，建议自己实现。\n// 如果想自己实现，请通过 setCustomEvalExpression 来替换。\nexport function evalExpression(expression: string, data?: object): boolean {\n  if (typeof customEvalExpressionFn === 'function') {\n    return customEvalExpressionFn(expression, data);\n  }\n\n  if (!expression || typeof expression !== 'string') {\n    return false;\n  }\n\n  /* jshint evil:true */\n  try {\n    let debug = false;\n    const idx = expression.indexOf('debugger');\n    if (~idx) {\n      debug = true;\n      expression = expression.replace(/debugger;?/, '');\n    }\n\n    const fn = new Function(\n      'data',\n      'utils',\n      `with(data) {${debug ? 'debugger;' : ''}return !!(${expression});}`\n    );\n    data = data || {};\n    return fn.call(data, data, getFilters());\n  } catch (e) {\n    console.warn(e);\n    return false;\n  }\n}\n\nlet customEvalJsFn: (expression: string, data?: any) => any;\nexport function setCustomEvalJs(fn: (expression: string, data?: any) => any) {\n  customEvalJsFn = fn;\n}\n\n// 这个主要用在 formula 里面，用来动态的改变某个值。也很粗暴，建议自己实现。\n// 如果想自己实现，请通过 setCustomEvalJs 来替换。\nexport function evalJS(js: string, data: object): any {\n  if (typeof customEvalJsFn === 'function') {\n    return customEvalJsFn(js, data);\n  }\n\n  /* jshint evil:true */\n  try {\n    const fn = new Function(\n      'data',\n      'utils',\n      `with(data) {${/^\\s*return\\b/.test(js) ? '' : 'return '}${js};}`\n    );\n    data = data || {};\n    return fn.call(data, data, getFilters());\n  } catch (e) {\n    console.warn(e);\n    return null;\n  }\n}\n"
    ]
}