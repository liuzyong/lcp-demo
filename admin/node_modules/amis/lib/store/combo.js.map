{
    "version": 3,
    "file": "combo.js",
    "sourceRoot": "",
    "sources": [
        "/src/store/combo.ts"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import {types, SnapshotIn, isAlive} from 'mobx-state-tree';\nimport {iRendererStore} from './iRenderer';\nimport {FormItemStore, IFormItemStore} from './formItem';\nimport {FormStore, IFormStore} from './form';\n\nexport const UniqueGroup = types.model('UniqueGroup', {\n  name: types.identifier,\n  items: types.array(types.reference(types.late(() => FormItemStore)))\n});\n\nexport type IUniqueGroup = typeof UniqueGroup.Type;\n\nexport const ComboStore = iRendererStore\n  .named('ComboStore')\n  .props({\n    uniques: types.map(UniqueGroup),\n    forms: types.array(types.reference(types.late(() => FormStore))),\n    minLength: 0,\n    maxLength: 0,\n    length: 0,\n    activeKey: 0\n  })\n  .views(self => ({\n    get addable() {\n      if (self.maxLength && self.length >= self.maxLength) {\n        return false;\n      }\n\n      if (self.uniques.size) {\n        let isFull = false;\n        self.uniques.forEach(item => {\n          if (isFull || !item.items.length) {\n            return;\n          }\n\n          let total = item.items[0].options.length;\n          let current = item.items.reduce((total, item) => {\n            return total + item.selectedOptions.length;\n          }, 0);\n\n          isFull = total && current >= total ? true : false;\n        });\n\n        if (isFull) {\n          return false;\n        }\n      }\n\n      return true;\n    },\n\n    get removable() {\n      if (self.minLength && self.minLength >= self.length) {\n        return false;\n      }\n\n      return true;\n    }\n  }))\n  .actions(self => {\n    function config(setting: {\n      minLength?: number;\n      maxLength?: number;\n      length?: number;\n    }) {\n      typeof setting.minLength !== 'undefined' &&\n        (self.minLength = parseInt(setting.minLength as any, 10));\n      typeof setting.maxLength !== 'undefined' &&\n        (self.maxLength = parseInt(setting.maxLength as any, 10));\n      typeof setting.length !== 'undefined' && (self.length = setting.length);\n    }\n\n    function bindUniuqueItem(item: IFormItemStore) {\n      if (!self.uniques.has(item.name)) {\n        self.uniques.put({\n          name: item.name\n        });\n      }\n      let group: IUniqueGroup = self.uniques.get(item.name) as IUniqueGroup;\n      group.items.push(item);\n    }\n\n    function unBindUniuqueItem(item: IFormItemStore) {\n      let group: IUniqueGroup = self.uniques.get(item.name) as IUniqueGroup;\n      group.items.remove(item);\n      if (!group.items.length) {\n        self.uniques.delete(item.name);\n      }\n    }\n\n    function addForm(form: IFormStore) {\n      self.forms.push(form);\n    }\n\n    function removeForm(form: IFormStore) {\n      // form 可能再它自己销毁的是已经被移除了。因为调用的是 destroy，所以 self.forms 里面也被一起移除。\n      // 再来尝试移除，会报错。\n      self.forms.includes(form) && self.forms.remove(form);\n    }\n\n    function setActiveKey(key: number) {\n      self.activeKey = key;\n    }\n\n    return {\n      config,\n      setActiveKey,\n      bindUniuqueItem,\n      unBindUniuqueItem,\n      addForm,\n      removeForm\n    };\n  });\n\nexport type IComboStore = typeof ComboStore.Type;\nexport type SComboStore = SnapshotIn<typeof ComboStore>;\n"
    ]
}